!function (e, t, o, i) { "use strict"; e.fn.userTimeout = function (i) { e(t).ajaxComplete(function (e, t, o) { "/umbraco/api/keepalive/keepalive" !== o.url && m() }); var a, r, n, l, u, s, d, c, f = e.extend({ logouturl: null, referer: !1, refererName: "refer", notify: !0, timer: !0, session: 6e5, force: 1e4, ui: "auto", debug: !1, modalTitle: "Session Timeout", modalBody: "You're being timed out due to inactivity. Please choose to stay signed in or to logoff. Otherwise, you will logged off automatically.", modalLogOffBtn: "Log Off", modalStayLoggedBtn: "Stay Logged In" }, i || {}), m = function (e) { switch (clearTimeout(a), clearTimeout(r), l = (new Date).getTime(), u = 0, s = 0, e) { case "logout": n = Math.floor(f.force / 1e3), r = setTimeout(function () { p(e) }, 100); break; default: a = setTimeout(function () { p(e) }, 100) } }, p = function (t) { switch (u += 100, d = (new Date).getTime() - l - u, t) { case "logout": u >= f.force ? h() : (1e3 === (s += 100) && 0 !== n && (n -= 1, e("#countdowntimer").html(n), s = 0), r = setTimeout(function () { p(t) }, 100 - d)); break; default: u >= f.session ? !0 === f.notify ? b() : h() : a = setTimeout(function () { p(t) }, 100 - d) } }, g = function (t) { switch (t) { case "auto": if ("function" == typeof e().emulateTransitionEnd) c = "bootstrap"; else { if (void 0 === jQuery.ui) return !0 === f.debug ? o.alert("Twitter Bootstrap 3 nor jQueryUI was not found! Please load the proper libraries and their themes to utilize this plugin!") : o.console.error("Twitter Bootstrap 3 nor jQueryUI was not found! Please load the proper libraries and their themes to utilize this plugin!"), !1; c = "jqueryui" } break; case "bootstrap": if ("function" != typeof e().emulateTransitionEnd) return !0 === f.debug ? o.alert("Twitter Bootstrap 3 was not found! Please load the proper libraries and their themes to utilize this plugin!") : o.console.error("Twitter Bootstrap 3 was not found! Please load the proper libraries and their themes to utilize this plugin!"), !1; c = "bootstrap"; break; case "jqueryui": if (void 0 === jQuery.ui) return !0 === f.debug ? o.alert("jQueryUI was not found! Please load the proper libraries and their themes to utilize this plugin!") : o.console.error("jQueryUI was not found! Please load the proper libraries and their themes to utilize this plugin!"), !1; c = "jqueryui"; break; default: return !0 === f.debug ? o.alert("Twitter Bootstrap 3 nor jQueryUI was not found! Please load the proper libraries and their themes to utilize this plugin!") : o.console.error("Twitter Bootstrap 3 nor jQueryUI was not found! Please load the proper libraries and their themes to utilize this plugin!"), !1 }return !0 }, b = function () { var t, o, i, a, r, l, u; if (m("logout"), "bootstrap" === c) t = e('<div class="modal fade" id="notifyLogout" tabindex="-1" role="dialog" aria-labelledby="notifyLogoutLabel" aria-hidden="true"></div>'), o = e('<div class="modal-dialog"></div>'), i = e('<div class="modal-content"></div>'), a = e('<div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title" id="notifyLogoutLabel">' + f.modalTitle + "</h4></div>"), r = e('<div class="modal-body">' + f.modalBody + "</div>"), l = !0 === f.timer ? e('<div class="modal-footer"><button type="button" class="btn btn-primary" data-dismiss="modal" onclick="callKeepAlive();">' + f.modalStayLoggedBtn + ' (<span id="countdowntimer">' + n + "</span>)</button></div>") : e('<div class="modal-footer"><button type="button" class="btn btn-primary" data-dismiss="modal" onclick="callKeepAlive();">' + f.modalStayLoggedBtn + "</button></div>"), u = e('<button type="button" class="btn btn-default" id="logoff">' + f.modalLogOffBtn + "</button>"), l.prepend(u), i.append(a, r, l), o.append(i), t.append(o), e(t).modal({ backdrop: "static", keyboard: !1, show: !0 }), e(t).on("hide.bs.modal", function () { e(t).remove(), m() }), e(u).on("click", function () { h() }); else if ("jqueryui" === c) { var s, d = {}, p = '<div id="notifyLogout"><p>' + f.modalBody + "</p></div>"; d[f.modalStayLoggedBtn] = function () { s.dialog("close"), m() }, d[f.modalLogOffBtn] = function () { h() }, s = e(p).dialog({ buttons: d, modal: !0, width: 600, height: 300, resizable: !1, title: f.modalTitle }) } }, h = function () { var t; if (clearTimeout(a), clearTimeout(r), !1 !== f.referer) if ("auto" === f.referer) { var i = e(location).attr("href"); t = f.logouturl + "?" + encodeURIComponent(f.refererName) + "=" + encodeURIComponent(i) } else t = f.logouturl + "?" + encodeURIComponent(f.refererName) + "=" + encodeURIComponent(f.referer); else t = f.logouturl; return o.location.replace(t) }; return this.each(function () { f.logouturl ? !1 !== g(f.ui) && m() : !0 === f.debug ? o.alert("Please configure the userTimeout plugin!") : o.console.error("Please configure the userTimeout plugin!") }) } }(jQuery, document, window); var callKeepAlive = function () { $.ajax({ url: "/umbraco/api/keepalive/keepalive" }) };